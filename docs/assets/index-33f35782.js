(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(e){if(e.ep)return;e.ep=!0;const o=t(e);fetch(e.href,o)}})();const i=document.getElementById("game"),n=i.getContext("2d"),x=document.getElementById("hud"),O=document.getElementById("startBtn"),S=document.getElementById("pauseBtn"),P=document.getElementById("restartBtn"),E=document.getElementById("instructions");i.width=600;i.height=600;let a=0,y=!1,h=!1,g;class T{constructor(){this.x=0,this.y=i.height/2,this.speed=40,this.health=3}update(s){this.x+=this.speed*s}draw(){n.font="24px sans-serif",n.fillStyle="#fff",n.fillText("👾",this.x,this.y)}}class b{constructor(s,t,r){this.x=s,this.y=t,this.target=r,this.speed=200}update(s){const t=this.target.x-this.x,r=this.target.y-this.y,e=Math.hypot(t,r);return e<5?(this.target.health-=1,!0):(this.x+=t/e*this.speed*s,this.y+=r/e*this.speed*s,!1)}draw(){n.font="20px sans-serif",n.fillStyle="#fff",n.fillText("✨",this.x,this.y)}}class B{constructor(s,t){this.x=s,this.y=t,this.range=80,this.cooldown=0}update(s,t){if(this.cooldown-=s,this.cooldown<=0){const r=t.find(e=>Math.hypot(e.x-this.x,e.y-this.y)<this.range);r&&(f.push(new b(this.x,this.y,r)),this.cooldown=.5)}}draw(){n.font="24px sans-serif",n.fillStyle="#fff",n.fillText("🏰",this.x-12,this.y)}}const c=[],d=[],f=[],j=i.height/2+12,w=20;let p=0;function L(){y||(y=!0,d.push(new B(i.width/2,i.height/2-50))),h||(h=!0,E.style.display="none",m=performance.now(),g=requestAnimationFrame(v))}function I(){h&&(h=!1,cancelAnimationFrame(g))}function A(){I(),c.length=0,d.length=0,f.length=0,a=0,x.textContent="💰0",y=!1,E.style.display="block"}O.addEventListener("click",L);S.addEventListener("click",I);P.addEventListener("click",A);i.addEventListener("click",l=>{if(!h){L();return}a>=5&&(d.push(new B(l.offsetX,l.offsetY)),a-=5)});let m=0;function v(l){const s=(l-m)/1e3;m=l,p-=s,p<=0&&(c.push(new T),p=2),n.clearRect(0,0,i.width,i.height),n.fillStyle="#333",n.fillRect(0,0,i.width,i.height),n.fillStyle="#555",n.fillRect(0,j-w/2,i.width,w);for(const t of c)t.update(s);for(const t of d)t.update(s,c);for(const t of f)t.update(s)&&f.splice(f.indexOf(t),1);c.filter(t=>t.health<=0).forEach(()=>{a+=1});for(let t=c.length-1;t>=0;t--)(c[t].health<=0||c[t].x>i.width)&&c.splice(t,1);for(const t of c)t.draw();for(const t of d)t.draw();for(const t of f)t.draw();x.textContent=`💰${a}`,g=requestAnimationFrame(v)}
