(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const g of n.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&o(g)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();const h=document.getElementById("game"),i=h.getContext("2d"),E=document.getElementById("hud"),O=document.getElementById("startBtn"),S=document.getElementById("pauseBtn"),P=document.getElementById("restartBtn"),p=document.getElementById("instructions"),k=document.getElementById("store"),m=[{emoji:"üè∞",name:"Basic Tower",damage:1,cost:5}],C=["‚ú®","üí•","üî•"],L=[{emoji:"üëæ",health:3,speed:40},{emoji:"ü§ñ",health:6,speed:35},{emoji:"ü¶π",health:10,speed:30}];function A(){k.innerHTML=`${m[0].emoji} ${m[0].name} - Cost ${m[0].cost}<br>Click tower to upgrade (cost 5√ólevel)`}A();let c=[];function M(){const r=Math.min(window.innerWidth,window.innerHeight)*.75;h.width=r,h.height=r;const e=h.width,t=h.height;c=[{x:0,y:t*.25},{x:e*.25,y:t*.25},{x:e*.25,y:t*.75},{x:e*.5,y:t*.75},{x:e*.5,y:t*.25},{x:e*.75,y:t*.25},{x:e*.75,y:t*.75},{x:e,y:t*.75}]}window.addEventListener("resize",M);M();let a=0,f=10,v=!1,y=!1,B,x=0;class F{constructor(e,t){this.type=e,this.x=c[0].x,this.y=c[0].y,this.speed=e.speed*t,this.health=Math.ceil(e.health*t),this.emoji=e.emoji,this.pathIndex=0}update(e){const t=c[this.pathIndex+1];if(!t)return!0;const o=t.x-this.x,s=t.y-this.y,n=Math.hypot(o,s);return n<this.speed*e?(this.x=t.x,this.y=t.y,this.pathIndex++):(this.x+=o/n*this.speed*e,this.y+=s/n*this.speed*e),this.pathIndex>=c.length-1}draw(){i.font="24px sans-serif",i.fillStyle="#fff",i.fillText(this.emoji,this.x-12,this.y+8)}}class G{constructor(e,t,o,s,n){this.x=e,this.y=t,this.target=o,this.emoji=s,this.damage=n,this.speed=200}update(e){const t=this.target.x-this.x,o=this.target.y-this.y,s=Math.hypot(t,o);return s<5?(this.target.health-=this.damage,!0):(this.x+=t/s*this.speed*e,this.y+=o/s*this.speed*e,!1)}draw(){i.font="20px sans-serif",i.fillStyle="#fff",i.fillText(this.emoji,this.x,this.y)}}class T{constructor(e,t){this.x=e,this.y=t,this.range=80,this.cooldown=0,this.level=1}upgrade(){return this.level<C.length?(this.level+=1,!0):!1}update(e,t){if(this.cooldown-=e,this.cooldown<=0){const o=t.find(s=>Math.hypot(s.x-this.x,s.y-this.y)<this.range);o&&(d.push(new G(this.x,this.y,o,C[this.level-1],this.level)),this.cooldown=.5)}}draw(){i.font="24px sans-serif",i.fillStyle="#fff",i.fillText("üè∞",this.x-12,this.y)}}const l=[],u=[],d=[],q=20;let w=0;function b(){v||(v=!0,u.push(new T(h.width/2,h.height/2-50))),y||(y=!0,p.style.display="none",E.textContent=`üí∞${a} ‚ù§Ô∏è${f}`,j=performance.now(),B=requestAnimationFrame($))}function I(){y&&(y=!1,cancelAnimationFrame(B))}function z(){I(),l.length=0,u.length=0,d.length=0,a=0,f=10,x=0,E.textContent=`üí∞${a} ‚ù§Ô∏è${f}`,v=!1,p.textContent="Click anywhere on the board to build towers and defend the path.",p.style.display="block"}O.addEventListener("click",b);S.addEventListener("click",I);P.addEventListener("click",z);h.addEventListener("click",r=>{if(!y){b();return}const e=u.find(t=>Math.hypot(t.x-r.offsetX,t.y-r.offsetY)<20);if(e){const t=e.level*5;a>=t&&e.upgrade()&&(a-=t)}else{const t=m[0].cost;a>=t&&(u.push(new T(r.offsetX,r.offsetY)),a-=t)}});let j=0;function $(r){const e=(r-j)/1e3;if(j=r,w-=e,w<=0){const t=1+x*.05,o=L[Math.min(L.length-1,Math.floor(x/10))];l.push(new F(o,t)),x++,w=2}i.clearRect(0,0,h.width,h.height),i.fillStyle="#333",i.fillRect(0,0,h.width,h.height),i.strokeStyle="#555",i.lineWidth=q,i.beginPath(),i.moveTo(c[0].x,c[0].y);for(const t of c.slice(1))i.lineTo(t.x,t.y);i.stroke();for(const t of l)t.update(e)&&(f-=1);for(const t of u)t.update(e,l);for(const t of d)t.update(e)&&d.splice(d.indexOf(t),1);l.filter(t=>t.health<=0).forEach(()=>{a+=1});for(let t=l.length-1;t>=0;t--)(l[t].health<=0||l[t].pathIndex>=c.length-1)&&l.splice(t,1);for(const t of l)t.draw();for(const t of u)t.draw();for(const t of d)t.draw();E.textContent=`üí∞${a} ‚ù§Ô∏è${f}`,f<=0&&(I(),p.textContent="Game Over",p.style.display="block"),B=requestAnimationFrame($)}
