(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(e){if(e.ep)return;e.ep=!0;const r=t(e);fetch(e.href,r)}})();const i=document.getElementById("game"),o=i.getContext("2d"),L=document.getElementById("hud"),g=document.getElementById("intro");i.width=600;i.height=600;let h=0,p=!1;class O{constructor(){this.x=0,this.y=i.height/2,this.speed=40,this.health=3}update(s){this.x+=this.speed*s}draw(){o.font="24px sans-serif",o.fillStyle="#fff",o.fillText("👾",this.x,this.y)}}class S{constructor(s,t,n){this.x=s,this.y=t,this.target=n,this.speed=200}update(s){const t=this.target.x-this.x,n=this.target.y-this.y,e=Math.hypot(t,n);return e<5?(this.target.health-=1,!0):(this.x+=t/e*this.speed*s,this.y+=n/e*this.speed*s,!1)}draw(){o.font="20px sans-serif",o.fillStyle="#fff",o.fillText("✨",this.x,this.y)}}class w{constructor(s,t){this.x=s,this.y=t,this.range=80,this.cooldown=0}update(s,t){if(this.cooldown-=s,this.cooldown<=0){const n=t.find(e=>Math.hypot(e.x-this.x,e.y-this.y)<this.range);n&&(f.push(new S(this.x,this.y,n)),this.cooldown=.5)}}draw(){o.font="24px sans-serif",o.fillStyle="#fff",o.fillText("🏰",this.x-12,this.y)}}const l=[],a=[],f=[],v=i.height/2+12,m=20;let u=0;function x(){p||(p=!0,g.style.display="none",a.push(new w(i.width/2,i.height/2-50)),y=performance.now(),requestAnimationFrame(E))}g.addEventListener("click",x);i.addEventListener("click",c=>{if(!p){x();return}h>=5&&(a.push(new w(c.offsetX,c.offsetY)),h-=5)});let y=0;function E(c){const s=(c-y)/1e3;y=c,u-=s,u<=0&&(l.push(new O),u=2),o.clearRect(0,0,i.width,i.height),o.fillStyle="#333",o.fillRect(0,0,i.width,i.height),o.fillStyle="#555",o.fillRect(0,v-m/2,i.width,m);for(const t of l)t.update(s);for(const t of a)t.update(s,l);for(const t of f)t.update(s)&&f.splice(f.indexOf(t),1);l.filter(t=>t.health<=0).forEach(()=>{h+=1});for(let t=l.length-1;t>=0;t--)(l[t].health<=0||l[t].x>i.width)&&l.splice(t,1);for(const t of l)t.draw();for(const t of a)t.draw();for(const t of f)t.draw();L.textContent=`💰${h}`,requestAnimationFrame(E)}
