(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function t(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(e){if(e.ep)return;e.ep=!0;const r=t(e);fetch(e.href,r)}})();const i=document.getElementById("game"),n=i.getContext("2d"),x=document.getElementById("hud"),P=document.getElementById("startBtn"),T=document.getElementById("pauseBtn"),b=document.getElementById("restartBtn"),E=document.getElementById("instructions");let B;function L(){const o=Math.min(window.innerWidth,window.innerHeight)*.75;i.width=o,i.height=o,B=i.height/2+12}window.addEventListener("resize",L);L();let f=0,y=!1,h=!1,g;class j{constructor(){this.x=0,this.y=i.height/2,this.speed=40,this.health=3}update(s){this.x+=this.speed*s}draw(){n.font="24px sans-serif",n.fillStyle="#fff",n.fillText("👾",this.x,this.y)}}class A{constructor(s,t,c){this.x=s,this.y=t,this.target=c,this.speed=200}update(s){const t=this.target.x-this.x,c=this.target.y-this.y,e=Math.hypot(t,c);return e<5?(this.target.health-=1,!0):(this.x+=t/e*this.speed*s,this.y+=c/e*this.speed*s,!1)}draw(){n.font="20px sans-serif",n.fillStyle="#fff",n.fillText("✨",this.x,this.y)}}class v{constructor(s,t){this.x=s,this.y=t,this.range=80,this.cooldown=0}update(s,t){if(this.cooldown-=s,this.cooldown<=0){const c=t.find(e=>Math.hypot(e.x-this.x,e.y-this.y)<this.range);c&&(a.push(new A(this.x,this.y,c)),this.cooldown=.5)}}draw(){n.font="24px sans-serif",n.fillStyle="#fff",n.fillText("🏰",this.x-12,this.y)}}const l=[],d=[],a=[],w=20;let p=0;function I(){y||(y=!0,d.push(new v(i.width/2,i.height/2-50))),h||(h=!0,E.style.display="none",m=performance.now(),g=requestAnimationFrame(S))}function O(){h&&(h=!1,cancelAnimationFrame(g))}function C(){O(),l.length=0,d.length=0,a.length=0,f=0,x.textContent="💰0",y=!1,E.style.display="block"}P.addEventListener("click",I);T.addEventListener("click",O);b.addEventListener("click",C);i.addEventListener("click",o=>{if(!h){I();return}f>=5&&(d.push(new v(o.offsetX,o.offsetY)),f-=5)});let m=0;function S(o){const s=(o-m)/1e3;m=o,p-=s,p<=0&&(l.push(new j),p=2),n.clearRect(0,0,i.width,i.height),n.fillStyle="#333",n.fillRect(0,0,i.width,i.height),n.fillStyle="#555",n.fillRect(0,B-w/2,i.width,w);for(const t of l)t.update(s);for(const t of d)t.update(s,l);for(const t of a)t.update(s)&&a.splice(a.indexOf(t),1);l.filter(t=>t.health<=0).forEach(()=>{f+=1});for(let t=l.length-1;t>=0;t--)(l[t].health<=0||l[t].x>i.width)&&l.splice(t,1);for(const t of l)t.draw();for(const t of d)t.draw();for(const t of a)t.draw();x.textContent=`💰${f}`,g=requestAnimationFrame(S)}
