(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const i=document.getElementById("game"),o=i.getContext("2d"),x=document.getElementById("hud"),T=document.getElementById("startBtn"),b=document.getElementById("pauseBtn"),C=document.getElementById("restartBtn"),E=document.getElementById("instructions"),M=document.getElementById("store"),B=[{emoji:"🏰",name:"Basic Tower",damage:1,cost:5}];function P(){M.innerHTML=B.map(n=>`${n.emoji} ${n.name} - Damage ${n.damage} - Cost ${n.cost}`).join("<br>")}P();let L;function v(){const n=Math.min(window.innerWidth,window.innerHeight)*.75;i.width=n,i.height=n,L=i.height/2+12}window.addEventListener("resize",v);v();let f=0,p=!1,h=!1,g;class ${constructor(){this.x=0,this.y=i.height/2,this.speed=40,this.health=3}update(e){this.x+=this.speed*e}draw(){o.font="24px sans-serif",o.fillStyle="#fff",o.fillText("👾",this.x,this.y)}}class A{constructor(e,t,c){this.x=e,this.y=t,this.target=c,this.speed=200}update(e){const t=this.target.x-this.x,c=this.target.y-this.y,s=Math.hypot(t,c);return s<5?(this.target.health-=1,!0):(this.x+=t/s*this.speed*e,this.y+=c/s*this.speed*e,!1)}draw(){o.font="20px sans-serif",o.fillStyle="#fff",o.fillText("✨",this.x,this.y)}}class I{constructor(e,t){this.x=e,this.y=t,this.range=80,this.cooldown=0}update(e,t){if(this.cooldown-=e,this.cooldown<=0){const c=t.find(s=>Math.hypot(s.x-this.x,s.y-this.y)<this.range);c&&(l.push(new A(this.x,this.y,c)),this.cooldown=.5)}}draw(){o.font="24px sans-serif",o.fillStyle="#fff",o.fillText("🏰",this.x-12,this.y)}}const a=[],d=[],l=[],w=20;let m=0;function j(){p||(p=!0,d.push(new I(i.width/2,i.height/2-50))),h||(h=!0,E.style.display="none",y=performance.now(),g=requestAnimationFrame(S))}function O(){h&&(h=!1,cancelAnimationFrame(g))}function F(){O(),a.length=0,d.length=0,l.length=0,f=0,x.textContent="💰0",p=!1,E.style.display="block"}T.addEventListener("click",j);b.addEventListener("click",O);C.addEventListener("click",F);i.addEventListener("click",n=>{if(!h){j();return}const e=B[0].cost;f>=e&&(d.push(new I(n.offsetX,n.offsetY)),f-=e)});let y=0;function S(n){const e=(n-y)/1e3;y=n,m-=e,m<=0&&(a.push(new $),m=2),o.clearRect(0,0,i.width,i.height),o.fillStyle="#333",o.fillRect(0,0,i.width,i.height),o.fillStyle="#555",o.fillRect(0,L-w/2,i.width,w);for(const t of a)t.update(e);for(const t of d)t.update(e,a);for(const t of l)t.update(e)&&l.splice(l.indexOf(t),1);a.filter(t=>t.health<=0).forEach(()=>{f+=1});for(let t=a.length-1;t>=0;t--)(a[t].health<=0||a[t].x>i.width)&&a.splice(t,1);for(const t of a)t.draw();for(const t of d)t.draw();for(const t of l)t.draw();x.textContent=`💰${f}`,g=requestAnimationFrame(S)}
